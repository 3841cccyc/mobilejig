# 自定义关卡编辑器功能说明

## 功能概述

我已经按照您的要求重新设计了关卡编辑器功能，现在的流程如下：

## 新的功能流程

### 1. 关卡编辑器入口
- **位置**: 主界面 → 关卡编辑器按钮
- **变化**: 直接进入自定义编辑器，不再需要选择难度
- **功能**: 可以创建完全自定义的拼图关卡

### 2. 自定义关卡创建
- **网格大小**: 可以选择 M×N 的任意网格大小（2-10）
- **拼图块形状**: 
  - 规则形状：标准的正方形拼图块
  - 不规则形状：带有凹凸边缘的拼图块
- **自定义图片**: 可以上传自己的图片作为拼图背景
- **实时预览**: 创建过程中可以看到网格预览和难度评估

### 3. 关卡保存
- **保存位置**: 自动保存到浏览器的localStorage
- **保存内容**: 包含网格大小、拼图块形状、图片、拼图块数据等
- **返回流程**: 保存后自动返回主界面

### 4. 开始游戏中的自定义关卡
- **位置**: 开始游戏 → 难度选择 → 自定义关卡
- **检查机制**: 如果没有创建过自定义关卡，会提示先创建
- **关卡选择**: 显示所有已创建的自定义关卡
- **关卡信息**: 显示关卡名称、网格大小、拼图块形状等信息

### 5. 自定义关卡游玩
- **游戏体验**: 与标准关卡完全相同的游戏体验
- **图片加载**: 使用创建时上传的自定义图片
- **难度设置**: 自定义关卡使用1.5倍分数倍数，无时间限制

## 技术实现

### 数据结构
```typescript
interface CustomLevel {
  id: number;
  name: string;
  rows: number;
  cols: number;
  pieceShape: 'regular' | 'irregular';
  imageUrl: string;
  pieces: any[];
  gridSize: number;
  timestamp: number;
}
```

### 存储方式
- 使用 `localStorage` 存储自定义关卡
- 键名: `customLevels`
- 格式: JSON数组

### 组件更新
1. **Homepage**: 关卡编辑器按钮直接跳转到自定义编辑器
2. **DifficultySelection**: 添加自定义关卡选项
3. **LevelSelection**: 支持显示和选择自定义关卡
4. **CustomDifficultyEditor**: 新的自定义关卡创建界面
5. **Editor**: 支持自定义配置和保存功能
6. **GamePage**: 支持加载和游玩自定义关卡

## 使用流程

1. **创建关卡**:
   - 主界面 → 关卡编辑器 → 设置参数 → 设计拼图 → 保存

2. **游玩关卡**:
   - 主界面 → 开始游戏 → 自定义关卡 → 选择关卡 → 开始游戏

## 注意事项

- 自定义关卡数据存储在浏览器本地，清除浏览器数据会丢失
- 建议定期备份重要的自定义关卡
- 图片URL需要是可访问的公开链接
- 网格大小建议在2-10之间，过大会影响性能

## 未来扩展

- 可以添加关卡分享功能
- 可以添加关卡导入/导出功能
- 可以添加更多拼图块形状选项
- 可以添加关卡评分和评论系统
